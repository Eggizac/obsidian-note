# Практическая работа  
**Нормализация отношения из 3НФ в НФБК**  
**Предметная область: Кинотеатр (расписание сеансов)**

---

### 1. Структура атрибутов исходного отношения  
**Исходное отношение - Сеанс**  
**Атрибуты**

| Атрибут       |
| ------------- |
| Код сеанса    |
| Название зала |
| Вместимость   |

---

### 2. Пример наполнения исходного отношения данными  

| Код сеанса | Название зала | Вместимость |
| ---------- | ------------- | ----------- |
| S101       | Красный       | 250         |
| S102       | Красный       | 250         |
| S103       | Синий         | 180         |
| S104       | Зелёный       | 120         |
| S105       | Красный       | 250         |

---

### 3. Схема атрибутов отношения с зависимостями  

1. {Название зала} -> {Вместимость}
2. {Код сеанса} -> {Название зала, Вместимость}


---

### 4. Текстовое описание функциональных зависимостей  
a. **Функциональная зависимость** {Название зала} - {Вместимость}
   Каждый зал имеет строго одну вместимость (фиксированное количество мест).  
   **Детерминант - Название зала** (простой атрибут)  

b. **Функциональная зависимость** {Код сеанса} - {Название зала, Вместимость}
   По коду сеанса однозначно определяется зал и его вместимость.

---

### 5. Текстовое описание всех атрибутов отношения  
- **Код сеанса** — уникальный идентификатор сеанса (например, S101). Первичный ключ.  
- **Название зала** — название кинозала (Красный, Синий, Зелёный).  
- **Вместимость** — количество посадочных мест в зале (например, 250).

---

### 6. Определение ключей  
**Первичный ключ** - **Код сеанса**  
**Потенциальных ключей** больше нет.

---

### 7. Определение нормальной формы исходного отношения  
Отношение находится в **3НФ**, потому что:  
- Все значения атомарны - 1НФ  
- Ключ простой - нет частичных зависимостей - 2НФ  
- Нет транзитивных зависимостей через другие неключевые атрибуты - 3НФ  

**НО НЕ в НФБК**, потому что:  
- Существует детерминант **Название зала - Вместимость**, который **не является суперключом** (не совпадает с Код сеанса).  
- Нарушение НФБК.

---

### 8. Аномалии исходного отношения  
a. **Аномалия вставки**: нельзя добавить новый зал с его вместимостью без создания хотя бы одного сеанса в нём  
b. **Аномалия удаления**: при удалении последнего сеанса в зале «Красный» теряется информация, что он вмещает 250 человек  
c. **Аномалия обновления**: изменение вместимости зала «Красный» требует правки всех строк с этим залом

---

### 9. Иллюстрация аномалий  
- Хотим добавить новый зал «VIP» на 50 мест - вынуждены создать фиктивный сеанс.  
- Удаляем последний сеанс S105 - исчезает факт, что зал «Красный» имеет 250 мест.  
- Зал «Красный» реконструировали до 280 мест - нужно обновить все строки с Код сеанса, где был «Красный».

---

### 10. Для устранения этих аномалий следует произвести  
Декомпозицию отношения с вынесением зависимости -Название зала - Вместимость  в отдельную таблицу.

---

### 11. Результат выполнения нормализации (НФБК)  

#### i. Зал  
Схема:  {Название зала} - {Вместимость}   
Ключ: **Название зала**

#### ii. Сеанс  
Схема:  {Код сеанса} - {Название зала}   
Ключ: **Код сеанса**

---

### 12. Иллюстрация того, что обозначенные выше аномалии в полученных отношениях пропали  
- **Вставка**: новый зал «VIP» на 50 мест добавляется одной строкой в таблицу  Зал  без создания сеанса.  
- **Удаление**: удаление всех сеансов в зале «Красный» не удаляет данные о его вместимости.  
- **Обновление**: изменение вместимости зала «Красный» - одна операция в таблице  Зал .

---

### 13. Причина аномалий в исходном отношении  
Наличие детерминанта **Название зала**, который определяет неключевой атрибут **Вместимость**, но **не является суперключом** отношения.

---

### 14. Проверка полученных отношений на соответствие нормальным формам  

| Отношение                                 | 1НФ | 2НФ | 3НФ | НФБК | Обоснование                                  |
| ----------------------------------------- | --- | --- | --- | ---- | -------------------------------------------- |
| **Зал** ( Название зала ,  Вместимость )  | Да | Да | Да | Да  | Детерминант Название зала = ключ - суперключ |
| **Сеанс** ( Код сеанса ,  Название зала ) | Да | Да | Да | Да  | Детерминант Код сеанса = ключ - суперключ    |

---
# Практическая работа  
**Нормализация отношения из НФБК в 4НФ**  
**Предметная область: Кинотеатр (прокат фильмов)**

---

### 1. Структура атрибутов исходного отношения  
**Исходное отношение - Прокат**  
**Атрибуты**

| Атрибут                |
|------------------------|
| Название фильма        |
| Название кинотеатра    |
| Название жанра         |

---

### 2. Пример наполнения исходного отношения данными  

| Название фильма | Название кинотеатра | Название жанра |
|-----------------|---------------------|----------------|
| Матрица         | Космос              | Боевик         |
| Матрица         | Космос              | Фантастика     |
| Матрица         | Империя             | Боевик         |
| Матрица         | Империя             | Фантастика     |
| Титаник         | Океан               | Драма          |
| Титаник         | Океан               | Мелодрама      |

---

### 3. Схема атрибутов отношения с зависимостями  
1. {Название фильма} -> {Название кинотеатра}
2. {Название фильма} -> {Название жанра}


---

### 4. Текстовое описание зависимостей  
a. **Многозначная зависимость**  {Название фильма} -- {Название кинотеатра}   
   Один фильм может идти в нескольких кинотеатрах независимо от жанров.  

b. **Многозначная зависимость**  {Название фильма} -- {Название жанра}   
   Один фильм может принадлежать нескольким жанрам независимо от кинотеатров.  

**Детерминант обеих MVD - Название фильма**

---

### 5. Текстовое описание всех атрибутов отношения  
- **Название фильма** — полное название фильма (например, «Матрица»).  
- **Название кинотеатра** — название кинотеатра сети (например, «Космос», «Империя»).  
- **Название жанра** — жанр фильма (Боевик, Фантастика, Драма и т.д.).

---

### 6. Определение ключей  
**Первичный ключ** — составной  {Название фильма, Название кинотеатра, Название жанра} 

---

### 7. Определение нормальной формы исходного отношения  
Отношение находится в **НФБК**, но **не в 4НФ**, потому что:  
- Существуют две **нетривиальные многозначные зависимости** с общим детерминантом «Название фильма», который **не является суперключом**.

---

### 11. Результат выполнения нормализации (4НФ)  

1. **Фильм**  
    {Название фильма}  - PK: Название фильма  

2. **Фильм_Кинотеатр**  
    {Название фильма, Название кинотеатра}  - PK: {Название фильма, Название кинотеатра}  

3. **Фильм_Жанр**  
    {Название фильма, Название жанра}  - PK: {Название фильма, Название жанра}

---

### 12. Иллюстрация того, что аномалии пропали  
- Новый фильм добавляется одной строкой в таблицу **Фильм** — без кинотеатров и жанров.  
- Удаление всех кинотеатров или всех жанров **не удаляет сам фильм**.  
- Добавление нового кинотеатра/жанра — одна строка, без дублирования.

---

### 14. Проверка полученных отношений  

| Отношение           | 1НФ | 2НФ | 3НФ | НФБК | 4НФ | Обоснование |
|---------------------|-----|-----|-----|------|-----|-------------|
| Фильм               | Да | Да | Да | Да | Да | Только ключ |
| Фильм_Кинотеатр     | Да | Да | Да | Да | Да | Нет неключевых атрибутов |
| Фильм_Жанр          | Да | Да | Да | Да | Да | Нет неключевых атрибутов |

---
