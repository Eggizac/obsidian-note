# Практическая работа  
**Нормализация отношения из 3НФ в НФБК**  
**Предметная область: Поликлиника (расписание приёма врачей)**

---

### 1. Структура атрибутов исходного отношения  
**Исходное отношение – Приём**  
**Атрибуты**

| Атрибут                 |
|-------------------------|
| Код приёма              |
| Специальность врача     |
| Кабинет                 |

---

### 2. Пример наполнения исходного отношения данными  

| Код приёма | Специальность врача   | Кабинет |
|------------|-----------------------|---------|
| P1001      | Терапевт              | 201     |
| P1002      | Терапевт              | 201     |
| P1003      | Окулист               | 305     |
| P1004      | ЛОР                   | 408     |
| P1005      | Терапевт              | 201     |

---

### 3. Схема атрибутов отношения с зависимостями  
1. {Специальность врача} -> {Кабинет}
2. {Код приёма} -> {Специальность врача, Кабинет}


---

### 4. Текстовое описание функциональных зависимостей  
**Функциональная зависимость**  
 {Специальность врача} - {Кабинет}   
Каждый врач определённой специальности принимает строго в одном кабинете.  
**Детерминант - Специальность врача** (не является суперключом)

---

### 5. Текстовое описание всех атрибутов отношения  
- **Код приёма** - уникальный идентификатор записи на приём (первичный ключ).  
- **Специальность врача** - специальность (Терапевт, Окулист, ЛОР и т.д.).  
- **Кабинет** - номер кабинета, закреплённый за специальностью.

---

### 6. Определение ключей  
**Первичный ключ** - **Код приёма**

---

### 7. Определение нормальной формы исходного отношения  
Отношение находится в **3НФ**, но **не в НФБК**, потому что существует детерминант **Специальность врача - Кабинет**, который **не является суперключом**.

---

### 8. Аномалии исходного отношения 
a. **Аномалия вставки** - нельзя добавить новую специальность с кабинетом без создания хотя бы одного приёма. 
b. **Аномалия удаления** - удаление последнего приёма терапевта - потеря информации, что терапевты принимают в 201 кабинете. 
c. **Аномалия обновления** - перенос окулистов из 305 в 310 кабинет требует изменения всех строк с окулистами.

### 9. Иллюстрация аномалий 
- Хотим добавить специальность «Невролог», кабинет 512 - вынуждены создать фиктивный приём. 
- Удаляем последний приём у ЛОРа - теряем факт, что ЛОР принимает в 408. 
- Меняем кабинет терапевтов на 202 - нужно обновить все строки с «Терапевт».

### 10. Для устранения этих аномалий следует произвести 
Декомпозицию с вынесением зависимости  Специальность врача - Кабинет  в отдельное отношение.

### 11. Результат выполнения нормализации (НФБК)

| Новое отношение        | Схема                                     | Первичный ключ         |
|------------------------|-------------------------------------------|-------------------------|
| Специальность          | {Специальность врача} - {Кабинет}         | Специальность врача     |
| Приём                  | {Код приёма} - {Специальность врача}     | Код приёма              |

---
### **12. Иллюстрация того, что обозначенные выше аномалии в полученных отношениях пропали**

- Добавление новой специальности «Кардиолог» с кабинетом 415 - одна строка в таблице «Специальность врача», без создания приёма.
- Удаление всех приёмов терапевтов - информация о кабинете 201 остаётся в таблице-справочнике.
- Изменение кабинета окулистов с 305 на 310 - одна операция UPDATE в таблице «Специальность врача», а не во всех строках приёмов.

### **13. Причина аномалий в исходном отношении**
Наличие детерминанта **Специальность врача**, который определяет неключевой атрибут **Кабинет**, но при этом **не является суперключом** отношения (суперключ - только Код приёма)

### 14. Проверка полученных отношений  

| Отношение       | 1НФ | 2НФ | 3НФ | НФБК | Обоснование                     |
|-----------------|-----|-----|-----|------|---------------------------------|
| Специальность   | Yes | Yes | Yes | Yes  | Детерминант = ключ              |
| Приём           | Yes | Yes | Yes | Yes  | Детерминант = ключ              |

---

### Практическая работа №2  
**Нормализация из НФБК в 4НФ**  
**Отношение: Назначение**

# Практическая работа  
**Нормализация отношения из НФБК в 4НФ**  
**Предметная область: Поликлиника (назначенные процедуры)**

---

### 1. Структура атрибутов исходного отношения  
**Исходное отношение – Назначение**  
**Атрибуты**

| Атрибут               |
|-----------------------|
| Код пациента          |
| Код лекарства         |
| Код процедуры         |

---

### 2. Пример наполнения исходного отношения данными  

| Код пациента | Код лекарства | Код процедуры |
|--------------|---------------|---------------|
| PAT01        | L101          | PR01          |
| PAT01        | L101          | PR05          |
| PAT01        | L205          | PR01          |
| PAT01        | L205          | PR05          |
| PAT02        | L101          | PR03          |
| PAT02        | L101          | PR07          |

---

### 3. Схема атрибутов отношения с зависимостями  
1. {Код пациента} -> {Код лекарства}
2. {Код пациента} -> {Код процедуры}


---

### 4. Текстовое описание зависимостей  
a. **Многозначная зависимость**  
 {Код пациента} -- {Код лекарства}  - один пациент может получать несколько лекарств независимо от процедур.  

b. **Многозначная зависимость**  
 {Код пациента} -- {Код процедуры}  - один пациент может проходить несколько процедур независимо от лекарств.

**Детерминант - Код пациента** (не суперключ)

---

### 5. Текстовое описание всех атрибутов отношения  
- **Код пациента** - уникальный идентификатор пациента.  
- **Код лекарства** - код назначенного лекарственного препарата.  
- **Код процедуры** - код назначенной медицинской процедуры.

---

### 6. Определение ключей  
**Первичный ключ** - составной  {Код пациента, Код лекарства, Код процедуры} 

---

### 7. Определение нормальной формы исходного отношения  
Отношение находится в **НФБК**, но **не в 4НФ**, из-за двух нетривиальных многозначных зависимостей с общим детерминантом, который не является суперключом.

---


### 8. Аномалии исходного отношения 
a. **Аномалия вставки** - нельзя добавить пациента без указания хотя бы одного лекарства и одной процедуры.
b. **Аномалия удаления** - удаление всех комбинаций - потеря самого пациента. 
c. **Избыточность** - добавление нового лекарства требует дублирования всех процедур пациента.

### 9. Иллюстрация аномалий 
- Пациент PAT03 назначены лекарства L300, L400 и процедуры PR10, PR11 - нужно вставить **4 строки**. 
- Удаляем все строки PAT01 - пациент полностью исчезает из системы. 
- Добавляем новое лекарство L777 к PAT01 - нужно добавить 2 строки (для каждой процедуры).

### 10. Для устранения этих аномалий следует произвести
Декомпозицию по двум многозначным зависимостям на три отношения.

### 11. Результат выполнения нормализации (4НФ)

| Новое отношение               | Схема                                     | Первичный ключ                        |
|-------------------------------|-------------------------------------------|----------------------------------------|
| Пациент                       | {Код пациента}                            | Код пациента                           |
| Пациент_Лекарство             | {Код пациента, Код лекарства}             | {Код пациента, Код лекарства}          |
| Пациент_Процедура             | {Код пациента, Код процедуры}             | {Код пациента, Код процедуры}          |

---

### **12. Иллюстрация того, что обозначенные выше аномалии в полученных отношениях пропали**

- Новый пациент PAT999 добавляется одной строкой в таблицу «Пациент» - без лекарств и процедур.
- Добавление нового лекарства или процедуры - по одной строке в соответствующей таблице, без дублирования.
- Удаление всех лекарств или всех процедур у пациента - сам пациент и оставшиеся назначения сохраняются в базе.

### **13. Причина аномалий в исходном отношении** 
Наличие двух **нетривиальных многозначных зависимостей** с общим детерминантом **Код пациента**, который **не является суперключом** исходного отношения (суперключ - все три атрибута вместе).

### 14. Проверка полученных отношений  

| Отношение             | 1НФ | 2НФ | 3НФ | НФБК | 4НФ | Обоснование                        |
|-----------------------|-----|-----|-----|------|-----|------------------------------------|
| Пациент               | Yes | Yes | Yes | Yes  | Yes | Только ключ                        |
| Пациент_Лекарство     | Yes | Yes | Yes | Yes  | Yes | Нет неключевых атрибутов - нет MVD |
| Пациент_Процедура     | Yes | Yes | Yes | Yes  | Yes | Нет неключевых атрибутов - нет MVD |

---
